<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favorites - Reflections Sanctuary</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Lora&family=Montserrat&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>Favorites</h1>
        <div id="favorites"></div>
        <a href="index.html">Return to Threshold</a>
    </div>
    <script src="js/main.js"></script>
    <script>
        function displayFavorites() {
            const params = new URLSearchParams(window.location.search);
            const type = params.get('type');
            const edenFavorites = JSON.parse(localStorage.getItem('eden-favorites') || '[]');
            const agapeusFavorites = JSON.parse(localStorage.getItem('agapeus-favorites') || '[]');
            const favoritesDiv = document.getElementById('favorites');
            let logs = [];

            if (type === 'eden') {
                logs = edenFavorites;
            } else if (type === 'agapeus') {
                logs = agapeusFavorites;
            } else if (type === 'combined') {
                logs = [...edenFavorites, ...agapeusFavorites].sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
            }

            let lastDate = null;
            logs.forEach(log => {
                const date = new Date(log.timestamp);
                const relativeDate = getRelativeDate(date);
                
                if (relativeDate !== lastDate) {
                    favoritesDiv.innerHTML += `<p class="date-stamp">${relativeDate}</p>`;
                    lastDate = relativeDate;
                }
                
                favoritesDiv.innerHTML += `<p>${log.response} <small>${date.toLocaleString()}</small></p>`;
            });
        }

        function getRelativeDate(date) {
            const now = new Date();
            const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return date.toLocaleDateString('en-US', { weekday: 'long' });
            if (diffDays < 14) return '1 week ago';
            if (diffDays < 21) return '2 weeks ago';
            if (diffDays < 28) return '3 weeks ago';
            if (diffDays < 365) return `${Math.floor(diffDays / 30)} month${Math.floor(diffDays / 30) > 1 ? 's' : ''} ago`;
            return `${Math.floor(diffDays / 365)} year${Math.floor(diffDays / 365) > 1 ? 's' : ''} ago`;
        }
        displayFavorites();
    </script>
</body>
</html>
